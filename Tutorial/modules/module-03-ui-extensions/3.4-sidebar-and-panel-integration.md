# 3.4 Sidebar and Panel Integration

## Introduction

VS Code's sidebar and panels are prime real estate for extension UI. Understanding how to create custom view containers, organize multiple views, and integrate with the activity bar enables you to build professional, well-integrated extensions that feel native to VS Code.

## What Are View Containers?

View containers are:
- **Organizational units** that hold one or more views
- **Activity bar entries** with custom icons
- **Collapsible sections** in the sidebar or panel area
- **Customizable** with badges, titles, and welcome content
- **Contextual** based on workspace and user state

## Activity Bar Contributions

The activity bar is the vertical bar on the far left that provides quick access to different views. You can add custom entries here.

### Creating a Custom Activity Bar Item

```typescript
// Extension code - no special logic needed for basic activity bar
export function activate(context: vscode.ExtensionContext) {
    vscode.window.registerTreeDataProvider(
        'myExtension.primaryView',
        new PrimaryViewProvider()
    );

    vscode.window.registerTreeDataProvider(
        'myExtension.secondaryView',
        new SecondaryViewProvider()
    );
}

class PrimaryViewProvider implements vscode.TreeDataProvider<string> {
    getTreeItem(element: string): vscode.TreeItem {
        return new vscode.TreeItem(element);
    }

    getChildren(element?: string): Thenable<string[]> {
        if (!element) {
            return Promise.resolve(['Item 1', 'Item 2', 'Item 3']);
        }
        return Promise.resolve([]);
    }
}

class SecondaryViewProvider implements vscode.TreeDataProvider<string> {
    getTreeItem(element: string): vscode.TreeItem {
        return new vscode.TreeItem(element);
    }

    getChildren(element?: string): Thenable<string[]> {
        if (!element) {
            return Promise.resolve(['Secondary 1', 'Secondary 2']);
        }
        return Promise.resolve([]);
    }
}
```

### package.json for Activity Bar

```json
{
    "contributes": {
        "viewsContainers": {
            "activitybar": [
                {
                    "id": "myExtension-container",
                    "title": "My Extension",
                    "icon": "resources/icon.svg"
                }
            ]
        },
        "views": {
            "myExtension-container": [
                {
                    "id": "myExtension.primaryView",
                    "name": "Primary View"
                },
                {
                    "id": "myExtension.secondaryView",
                    "name": "Secondary View"
                }
            ]
        }
    }
}
```

## View Containers in Different Locations

### Sidebar View Container

```json
{
    "contributes": {
        "viewsContainers": {
            "activitybar": [
                {
                    "id": "myExtension-sidebar",
                    "title": "My Sidebar Extension",
                    "icon": "$(book)"
                }
            ]
        },
        "views": {
            "myExtension-sidebar": [
                {
                    "id": "myExtension.sidebarView",
                    "name": "Sidebar Content"
                }
            ]
        }
    }
}
```

### Panel View Container

```json
{
    "contributes": {
        "viewsContainers": {
            "panel": [
                {
                    "id": "myExtension-panel",
                    "title": "My Panel Extension",
                    "icon": "$(terminal)"
                }
            ]
        },
        "views": {
            "myExtension-panel": [
                {
                    "id": "myExtension.panelView",
                    "name": "Panel Content"
                }
            ]
        }
    }
}
```

## Creating Custom Sidebars

### Webview-Based Sidebar

```typescript
import * as vscode from 'vscode';

class SidebarViewProvider implements vscode.WebviewViewProvider {

    public static readonly viewType = 'myExtension.sidebarView';

    private _view?: vscode.WebviewView;

    constructor(private readonly _extensionUri: vscode.Uri) {}

    public resolveWebviewView(
        webviewView: vscode.WebviewView,
        context: vscode.WebviewViewResolveContext,
        _token: vscode.CancellationToken
    ) {
        this._view = webviewView;

        webviewView.webview.options = {
            enableScripts: true,
            localResourceRoots: [this._extensionUri]
        };

        webviewView.webview.html = this._getHtmlForWebview(webviewView.webview);

        // Handle messages from webview
        webviewView.webview.onDidReceiveMessage(data => {
            switch (data.type) {
                case 'action':
                    vscode.window.showInformationMessage(`Action: ${data.value}`);
                    break;
            }
        });
    }

    public sendMessage(message: any) {
        if (this._view) {
            this._view.webview.postMessage(message);
        }
    }

    private _getHtmlForWebview(webview: vscode.Webview) {
        const styleUri = webview.asWebviewUri(
            vscode.Uri.joinPath(this._extensionUri, 'media', 'sidebar.css')
        );
        const scriptUri = webview.asWebviewUri(
            vscode.Uri.joinPath(this._extensionUri, 'media', 'sidebar.js')
        );

        const nonce = getNonce();

        return `<!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta http-equiv="Content-Security-Policy"
                  content="default-src 'none';
                           style-src ${webview.cspSource} 'unsafe-inline';
                           script-src 'nonce-${nonce}';">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <link href="${styleUri}" rel="stylesheet">
            <title>Sidebar</title>
        </head>
        <body>
            <div class="container">
                <h1>Sidebar View</h1>
                <button id="actionBtn">Perform Action</button>
                <div id="content">
                    <p>Custom sidebar content goes here</p>
                </div>
            </div>
            <script nonce="${nonce}" src="${scriptUri}"></script>
        </body>
        </html>`;
    }
}

function getNonce() {
    let text = '';
    const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    for (let i = 0; i < 32; i++) {
        text += possible.charAt(Math.floor(Math.random() * possible.length));
    }
    return text;
}

export function activate(context: vscode.ExtensionContext) {
    const provider = new SidebarViewProvider(context.extensionUri);

    context.subscriptions.push(
        vscode.window.registerWebviewViewProvider(
            SidebarViewProvider.viewType,
            provider
        )
    );
}
```

### package.json for Webview Sidebar

```json
{
    "contributes": {
        "viewsContainers": {
            "activitybar": [
                {
                    "id": "myExtension-sidebar",
                    "title": "My Extension",
                    "icon": "$(extensions)"
                }
            ]
        },
        "views": {
            "myExtension-sidebar": [
                {
                    "type": "webview",
                    "id": "myExtension.sidebarView",
                    "name": "Main View"
                }
            ]
        }
    }
}
```

## Panel Contributions

### Creating a Panel View

```typescript
import * as vscode from 'vscode';

class PanelViewProvider implements vscode.WebviewViewProvider {

    public static readonly viewType = 'myExtension.panelView';

    private _view?: vscode.WebviewView;

    constructor(private readonly _extensionUri: vscode.Uri) {}

    public resolveWebviewView(
        webviewView: vscode.WebviewView,
        context: vscode.WebviewViewResolveContext,
        _token: vscode.CancellationToken
    ) {
        this._view = webviewView;

        webviewView.webview.options = {
            enableScripts: true,
            localResourceRoots: [this._extensionUri]
        };

        webviewView.webview.html = this._getHtmlForWebview(webviewView.webview);

        // Handle visibility changes
        webviewView.onDidChangeVisibility(() => {
            if (webviewView.visible) {
                this.updateContent();
            }
        });
    }

    private updateContent() {
        if (this._view) {
            this._view.webview.postMessage({
                type: 'update',
                timestamp: new Date().toISOString()
            });
        }
    }

    private _getHtmlForWebview(webview: vscode.Webview) {
        return `<!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Panel View</title>
            <style>
                body {
                    padding: 10px;
                    color: var(--vscode-foreground);
                    background-color: var(--vscode-panel-background);
                    font-family: var(--vscode-font-family);
                }
                .panel-content {
                    border: 1px solid var(--vscode-panel-border);
                    padding: 10px;
                    border-radius: 4px;
                }
            </style>
        </head>
        <body>
            <div class="panel-content">
                <h2>Panel Content</h2>
                <div id="info">Loading...</div>
            </div>
            <script>
                const vscode = acquireVsCodeApi();
                window.addEventListener('message', event => {
                    const message = event.data;
                    if (message.type === 'update') {
                        document.getElementById('info').textContent =
                            'Last updated: ' + message.timestamp;
                    }
                });
            </script>
        </body>
        </html>`;
    }
}

export function activate(context: vscode.ExtensionContext) {
    const provider = new PanelViewProvider(context.extensionUri);

    context.subscriptions.push(
        vscode.window.registerWebviewViewProvider(
            PanelViewProvider.viewType,
            provider
        )
    );
}
```

### package.json for Panel

```json
{
    "contributes": {
        "viewsContainers": {
            "panel": [
                {
                    "id": "myExtension-panel",
                    "title": "My Extension Panel",
                    "icon": "$(output)"
                }
            ]
        },
        "views": {
            "myExtension-panel": [
                {
                    "type": "webview",
                    "id": "myExtension.panelView",
                    "name": "Output View"
                }
            ]
        }
    }
}
```

## View Visibility and Welcome Views

### Conditional View Visibility

```json
{
    "contributes": {
        "views": {
            "myExtension-sidebar": [
                {
                    "id": "myExtension.conditionalView",
                    "name": "Conditional View",
                    "when": "workspaceFolderCount > 0"
                }
            ]
        }
    }
}
```

### Welcome Views with Actions

```json
{
    "contributes": {
        "views": {
            "myExtension-sidebar": [
                {
                    "id": "myExtension.welcomeView",
                    "name": "Getting Started"
                }
            ]
        },
        "viewsWelcome": [
            {
                "view": "myExtension.welcomeView",
                "contents": "No items found.\n[Add New Item](command:myExtension.addItem)\nOr open a workspace folder to get started.\n[Open Folder](command:vscode.openFolder)"
            }
        ]
    }
}
```

## Badge Notifications

### Showing Badges on View Containers

```typescript
import * as vscode from 'vscode';

class BadgeManager {
    private _treeView: vscode.TreeView<string>;
    private _count: number = 0;

    constructor(treeView: vscode.TreeView<string>) {
        this._treeView = treeView;
    }

    public updateBadge(count: number) {
        this._count = count;

        if (count > 0) {
            this._treeView.badge = {
                tooltip: `${count} notifications`,
                value: count
            };
        } else {
            this._treeView.badge = undefined;
        }
    }

    public incrementBadge() {
        this.updateBadge(this._count + 1);
    }

    public clearBadge() {
        this.updateBadge(0);
    }
}

export function activate(context: vscode.ExtensionContext) {
    const treeDataProvider = new MyTreeDataProvider();
    const treeView = vscode.window.createTreeView('myExtension.badgeView', {
        treeDataProvider
    });

    const badgeManager = new BadgeManager(treeView);

    // Update badge based on some event
    context.subscriptions.push(
        vscode.commands.registerCommand('myExtension.addNotification', () => {
            badgeManager.incrementBadge();
        })
    );

    context.subscriptions.push(
        vscode.commands.registerCommand('myExtension.clearNotifications', () => {
            badgeManager.clearBadge();
        })
    );

    context.subscriptions.push(treeView);
}

class MyTreeDataProvider implements vscode.TreeDataProvider<string> {
    getTreeItem(element: string): vscode.TreeItem {
        return new vscode.TreeItem(element);
    }

    getChildren(element?: string): Thenable<string[]> {
        return Promise.resolve(['Item 1', 'Item 2']);
    }
}
```

## Multiple Views in One Container

### Organizing Related Views

```typescript
import * as vscode from 'vscode';

// First view provider
class ItemsViewProvider implements vscode.TreeDataProvider<string> {
    private _onDidChangeTreeData = new vscode.EventEmitter<string | undefined>();
    readonly onDidChangeTreeData = this._onDidChangeTreeData.event;

    private items: string[] = ['Item 1', 'Item 2', 'Item 3'];

    refresh(): void {
        this._onDidChangeTreeData.fire(undefined);
    }

    getTreeItem(element: string): vscode.TreeItem {
        return new vscode.TreeItem(element);
    }

    getChildren(element?: string): Thenable<string[]> {
        if (!element) {
            return Promise.resolve(this.items);
        }
        return Promise.resolve([]);
    }

    addItem(item: string): void {
        this.items.push(item);
        this.refresh();
    }
}

// Second view provider
class HistoryViewProvider implements vscode.TreeDataProvider<string> {
    private _onDidChangeTreeData = new vscode.EventEmitter<string | undefined>();
    readonly onDidChangeTreeData = this._onDidChangeTreeData.event;

    private history: string[] = [];

    addToHistory(item: string): void {
        this.history.unshift(`${new Date().toLocaleTimeString()}: ${item}`);
        if (this.history.length > 10) {
            this.history.pop();
        }
        this._onDidChangeTreeData.fire(undefined);
    }

    getTreeItem(element: string): vscode.TreeItem {
        return new vscode.TreeItem(element);
    }

    getChildren(element?: string): Thenable<string[]> {
        if (!element) {
            return Promise.resolve(this.history);
        }
        return Promise.resolve([]);
    }

    clearHistory(): void {
        this.history = [];
        this._onDidChangeTreeData.fire(undefined);
    }
}

// Third view - Settings
class SettingsViewProvider implements vscode.WebviewViewProvider {
    public static readonly viewType = 'myExtension.settingsView';

    resolveWebviewView(
        webviewView: vscode.WebviewView,
        context: vscode.WebviewViewResolveContext,
        _token: vscode.CancellationToken
    ) {
        webviewView.webview.options = {
            enableScripts: true
        };

        webviewView.webview.html = this._getHtmlForWebview();
    }

    private _getHtmlForWebview(): string {
        return `<!DOCTYPE html>
        <html>
        <body>
            <h2>Settings</h2>
            <label>
                <input type="checkbox" id="autoRefresh"> Auto Refresh
            </label>
            <br><br>
            <label>
                Refresh Interval (seconds):
                <input type="number" id="interval" value="5" min="1" max="60">
            </label>
        </body>
        </html>`;
    }
}

export function activate(context: vscode.ExtensionContext) {
    // Create providers
    const itemsProvider = new ItemsViewProvider();
    const historyProvider = new HistoryViewProvider();
    const settingsProvider = new SettingsViewProvider();

    // Register tree views
    context.subscriptions.push(
        vscode.window.registerTreeDataProvider('myExtension.itemsView', itemsProvider)
    );

    context.subscriptions.push(
        vscode.window.registerTreeDataProvider('myExtension.historyView', historyProvider)
    );

    context.subscriptions.push(
        vscode.window.registerWebviewViewProvider(
            SettingsViewProvider.viewType,
            settingsProvider
        )
    );

    // Add item command
    context.subscriptions.push(
        vscode.commands.registerCommand('myExtension.addItem', async () => {
            const item = await vscode.window.showInputBox({
                prompt: 'Enter item name'
            });
            if (item) {
                itemsProvider.addItem(item);
                historyProvider.addToHistory(`Added: ${item}`);
            }
        })
    );

    // Clear history command
    context.subscriptions.push(
        vscode.commands.registerCommand('myExtension.clearHistory', () => {
            historyProvider.clearHistory();
        })
    );
}
```

### package.json for Multiple Views

```json
{
    "contributes": {
        "viewsContainers": {
            "activitybar": [
                {
                    "id": "myExtension-container",
                    "title": "My Extension",
                    "icon": "$(package)"
                }
            ]
        },
        "views": {
            "myExtension-container": [
                {
                    "id": "myExtension.itemsView",
                    "name": "Items",
                    "icon": "$(list-unordered)",
                    "contextualTitle": "All Items"
                },
                {
                    "id": "myExtension.historyView",
                    "name": "History",
                    "icon": "$(history)",
                    "contextualTitle": "Recent History"
                },
                {
                    "type": "webview",
                    "id": "myExtension.settingsView",
                    "name": "Settings",
                    "icon": "$(settings-gear)",
                    "contextualTitle": "Extension Settings"
                }
            ]
        },
        "commands": [
            {
                "command": "myExtension.addItem",
                "title": "Add Item",
                "icon": "$(add)"
            },
            {
                "command": "myExtension.clearHistory",
                "title": "Clear History",
                "icon": "$(clear-all)"
            }
        ],
        "menus": {
            "view/title": [
                {
                    "command": "myExtension.addItem",
                    "when": "view == myExtension.itemsView",
                    "group": "navigation"
                },
                {
                    "command": "myExtension.clearHistory",
                    "when": "view == myExtension.historyView",
                    "group": "navigation"
                }
            ]
        }
    }
}
```

## Complete Example: Project Dashboard

### Dashboard Implementation

```typescript
import * as vscode from 'vscode';
import * as path from 'path';

// Dashboard overview provider
class DashboardViewProvider implements vscode.WebviewViewProvider {
    public static readonly viewType = 'projectDashboard.overview';

    private _view?: vscode.WebviewView;

    constructor(private readonly _extensionUri: vscode.Uri) {}

    resolveWebviewView(
        webviewView: vscode.WebviewView,
        context: vscode.WebviewViewResolveContext,
        _token: vscode.CancellationToken
    ) {
        this._view = webviewView;

        webviewView.webview.options = {
            enableScripts: true,
            localResourceRoots: [this._extensionUri]
        };

        webviewView.webview.html = this._getHtmlForWebview(webviewView.webview);

        // Update dashboard every 5 seconds
        const interval = setInterval(() => {
            this.updateDashboard();
        }, 5000);

        webviewView.onDidDispose(() => {
            clearInterval(interval);
        });

        // Initial update
        this.updateDashboard();
    }

    private async updateDashboard() {
        if (!this._view) {
            return;
        }

        const stats = await this.getProjectStats();

        this._view.webview.postMessage({
            type: 'update',
            stats
        });
    }

    private async getProjectStats() {
        const workspaceFolder = vscode.workspace.workspaceFolders?.[0];
        if (!workspaceFolder) {
            return {
                files: 0,
                folders: 0,
                lines: 0,
                languages: []
            };
        }

        // Simplified stats gathering
        const files = await vscode.workspace.findFiles('**/*', '**/node_modules/**', 1000);

        return {
            files: files.length,
            folders: new Set(files.map(f => path.dirname(f.fsPath))).size,
            lines: 0, // Would need to read files to count
            languages: ['TypeScript', 'JavaScript', 'HTML', 'CSS']
        };
    }

    private _getHtmlForWebview(webview: vscode.Webview): string {
        return `<!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Project Dashboard</title>
            <style>
                body {
                    padding: 10px;
                    color: var(--vscode-foreground);
                    background-color: var(--vscode-sideBar-background);
                    font-family: var(--vscode-font-family);
                }
                .stat-card {
                    background: var(--vscode-editor-background);
                    border: 1px solid var(--vscode-panel-border);
                    border-radius: 4px;
                    padding: 12px;
                    margin-bottom: 10px;
                }
                .stat-card h3 {
                    margin: 0 0 8px 0;
                    color: var(--vscode-textLink-foreground);
                    font-size: 14px;
                }
                .stat-value {
                    font-size: 24px;
                    font-weight: bold;
                }
                .language-tag {
                    display: inline-block;
                    background: var(--vscode-badge-background);
                    color: var(--vscode-badge-foreground);
                    padding: 2px 8px;
                    border-radius: 10px;
                    font-size: 11px;
                    margin: 2px;
                }
            </style>
        </head>
        <body>
            <h1>Project Overview</h1>

            <div class="stat-card">
                <h3>Files</h3>
                <div class="stat-value" id="files">-</div>
            </div>

            <div class="stat-card">
                <h3>Folders</h3>
                <div class="stat-value" id="folders">-</div>
            </div>

            <div class="stat-card">
                <h3>Languages</h3>
                <div id="languages">-</div>
            </div>

            <script>
                const vscode = acquireVsCodeApi();

                window.addEventListener('message', event => {
                    const message = event.data;
                    if (message.type === 'update') {
                        const { stats } = message;

                        document.getElementById('files').textContent = stats.files;
                        document.getElementById('folders').textContent = stats.folders;

                        const languagesDiv = document.getElementById('languages');
                        languagesDiv.innerHTML = stats.languages
                            .map(lang => \`<span class="language-tag">\${lang}</span>\`)
                            .join('');
                    }
                });
            </script>
        </body>
        </html>`;
    }
}

// Recent files provider
class RecentFilesProvider implements vscode.TreeDataProvider<FileItem> {
    private _onDidChangeTreeData = new vscode.EventEmitter<FileItem | undefined>();
    readonly onDidChangeTreeData = this._onDidChangeTreeData.event;

    private recentFiles: string[] = [];

    constructor() {
        // Track opened files
        vscode.window.onDidChangeActiveTextEditor(editor => {
            if (editor) {
                this.addRecentFile(editor.document.uri.fsPath);
            }
        });
    }

    addRecentFile(filePath: string): void {
        // Remove if exists and add to front
        this.recentFiles = this.recentFiles.filter(f => f !== filePath);
        this.recentFiles.unshift(filePath);

        // Keep only last 10
        if (this.recentFiles.length > 10) {
            this.recentFiles.pop();
        }

        this._onDidChangeTreeData.fire(undefined);
    }

    getTreeItem(element: FileItem): vscode.TreeItem {
        return element;
    }

    getChildren(element?: FileItem): Thenable<FileItem[]> {
        if (!element) {
            return Promise.resolve(
                this.recentFiles.map(filePath => new FileItem(filePath))
            );
        }
        return Promise.resolve([]);
    }

    clearHistory(): void {
        this.recentFiles = [];
        this._onDidChangeTreeData.fire(undefined);
    }
}

class FileItem extends vscode.TreeItem {
    constructor(public readonly filePath: string) {
        super(path.basename(filePath), vscode.TreeItemCollapsibleState.None);

        this.tooltip = filePath;
        this.description = path.dirname(filePath);
        this.iconPath = new vscode.ThemeIcon('file');
        this.resourceUri = vscode.Uri.file(filePath);

        this.command = {
            command: 'vscode.open',
            title: 'Open File',
            arguments: [vscode.Uri.file(filePath)]
        };
    }
}

// Quick actions provider
class QuickActionsProvider implements vscode.TreeDataProvider<ActionItem> {
    private actions: ActionItem[] = [
        new ActionItem('New File', 'file', 'workbench.action.files.newUntitledFile'),
        new ActionItem('Open Folder', 'folder-opened', 'vscode.openFolder'),
        new ActionItem('Search', 'search', 'workbench.action.findInFiles'),
        new ActionItem('Git: Commit', 'git-commit', 'git.commit'),
        new ActionItem('Terminal', 'terminal', 'workbench.action.terminal.new')
    ];

    getTreeItem(element: ActionItem): vscode.TreeItem {
        return element;
    }

    getChildren(element?: ActionItem): Thenable<ActionItem[]> {
        if (!element) {
            return Promise.resolve(this.actions);
        }
        return Promise.resolve([]);
    }
}

class ActionItem extends vscode.TreeItem {
    constructor(
        public readonly label: string,
        private readonly icon: string,
        private readonly commandId: string
    ) {
        super(label, vscode.TreeItemCollapsibleState.None);

        this.iconPath = new vscode.ThemeIcon(icon);
        this.command = {
            command: commandId,
            title: label
        };
    }
}

export function activate(context: vscode.ExtensionContext) {
    // Register dashboard overview
    const dashboardProvider = new DashboardViewProvider(context.extensionUri);
    context.subscriptions.push(
        vscode.window.registerWebviewViewProvider(
            DashboardViewProvider.viewType,
            dashboardProvider
        )
    );

    // Register recent files view
    const recentFilesProvider = new RecentFilesProvider();
    const recentFilesView = vscode.window.createTreeView('projectDashboard.recentFiles', {
        treeDataProvider: recentFilesProvider
    });
    context.subscriptions.push(recentFilesView);

    // Register quick actions view
    const quickActionsProvider = new QuickActionsProvider();
    context.subscriptions.push(
        vscode.window.registerTreeDataProvider(
            'projectDashboard.quickActions',
            quickActionsProvider
        )
    );

    // Commands
    context.subscriptions.push(
        vscode.commands.registerCommand('projectDashboard.clearRecentFiles', () => {
            recentFilesProvider.clearHistory();
        })
    );

    context.subscriptions.push(
        vscode.commands.registerCommand('projectDashboard.refresh', () => {
            vscode.window.showInformationMessage('Dashboard refreshed');
        })
    );
}
```

### package.json for Project Dashboard

```json
{
    "name": "project-dashboard",
    "displayName": "Project Dashboard",
    "description": "A comprehensive project overview dashboard",
    "version": "1.0.0",
    "engines": {
        "vscode": "^1.74.0"
    },
    "activationEvents": [],
    "main": "./out/extension.js",
    "contributes": {
        "viewsContainers": {
            "activitybar": [
                {
                    "id": "project-dashboard",
                    "title": "Project Dashboard",
                    "icon": "$(dashboard)"
                }
            ]
        },
        "views": {
            "project-dashboard": [
                {
                    "type": "webview",
                    "id": "projectDashboard.overview",
                    "name": "Overview",
                    "icon": "$(home)",
                    "contextualTitle": "Project Overview"
                },
                {
                    "id": "projectDashboard.recentFiles",
                    "name": "Recent Files",
                    "icon": "$(history)",
                    "contextualTitle": "Recently Opened"
                },
                {
                    "id": "projectDashboard.quickActions",
                    "name": "Quick Actions",
                    "icon": "$(zap)",
                    "contextualTitle": "Quick Actions"
                }
            ]
        },
        "commands": [
            {
                "command": "projectDashboard.refresh",
                "title": "Refresh Dashboard",
                "icon": "$(refresh)"
            },
            {
                "command": "projectDashboard.clearRecentFiles",
                "title": "Clear Recent Files",
                "icon": "$(clear-all)"
            }
        ],
        "menus": {
            "view/title": [
                {
                    "command": "projectDashboard.refresh",
                    "when": "view == projectDashboard.overview",
                    "group": "navigation"
                },
                {
                    "command": "projectDashboard.clearRecentFiles",
                    "when": "view == projectDashboard.recentFiles",
                    "group": "navigation"
                }
            ]
        }
    }
}
```

## Best Practices

### 1. View Container Organization

```typescript
// ✅ Good: Logical grouping
{
    "views": {
        "myExtension-container": [
            {
                "id": "myExtension.dataView",
                "name": "Data"
            },
            {
                "id": "myExtension.settingsView",
                "name": "Settings"
            }
        ]
    }
}

// ❌ Bad: Unrelated views in same container
{
    "views": {
        "myExtension-container": [
            {
                "id": "randomView1",
                "name": "Random 1"
            },
            {
                "id": "unrelatedView2",
                "name": "Unrelated 2"
            }
        ]
    }
}
```

### 2. View Visibility Management

```typescript
// ✅ Good: Conditional visibility with clear reasoning
{
    "views": {
        "myExtension-container": [
            {
                "id": "myExtension.gitView",
                "name": "Git Status",
                "when": "workspaceFolderCount > 0 && gitOpenRepositoryCount > 0"
            }
        ]
    }
}

// ❌ Bad: Always visible even when not applicable
{
    "views": {
        "myExtension-container": [
            {
                "id": "myExtension.gitView",
                "name": "Git Status"
                // No 'when' clause, shows even without git
            }
        ]
    }
}
```

### 3. Badge Usage

```typescript
// ✅ Good: Meaningful badge with tooltip
treeView.badge = {
    tooltip: '5 unread notifications',
    value: 5
};

// ❌ Bad: Badge without context
treeView.badge = {
    tooltip: 'Count',
    value: 42 // What does 42 mean?
};
```

### 4. Welcome Content

```typescript
// ✅ Good: Actionable welcome content
{
    "viewsWelcome": [
        {
            "view": "myExtension.view",
            "contents": "No workspace folder found.\n[Open Folder](command:vscode.openFolder)\nOr [Open Recent](command:workbench.action.openRecent)"
        }
    ]
}

// ❌ Bad: Vague welcome content
{
    "viewsWelcome": [
        {
            "view": "myExtension.view",
            "contents": "Nothing to show."
            // No actionable steps
        }
    ]
}
```

### 5. Resource Cleanup

```typescript
// ✅ Good: Proper disposal
export function activate(context: vscode.ExtensionContext) {
    const provider = new MyViewProvider(context.extensionUri);
    const disposable = vscode.window.registerWebviewViewProvider(
        MyViewProvider.viewType,
        provider
    );

    context.subscriptions.push(disposable);
}

// ❌ Bad: No cleanup
export function activate(context: vscode.ExtensionContext) {
    const provider = new MyViewProvider(context.extensionUri);
    vscode.window.registerWebviewViewProvider(
        MyViewProvider.viewType,
        provider
    );
    // Not added to subscriptions - potential memory leak
}
```

### 6. Performance Considerations

```typescript
// ✅ Good: Lazy loading and caching
class EfficientViewProvider implements vscode.WebviewViewProvider {
    private _view?: vscode.WebviewView;

    resolveWebviewView(webviewView: vscode.WebviewView) {
        this._view = webviewView;

        webviewView.webview.html = this._getHtmlForWebview();

        // Only update when visible
        webviewView.onDidChangeVisibility(() => {
            if (webviewView.visible) {
                this.updateContent();
            }
        });
    }

    private updateContent() {
        // Update only when needed
    }
}

// ❌ Bad: Constant updates regardless of visibility
class InefficientViewProvider implements vscode.WebviewViewProvider {
    resolveWebviewView(webviewView: vscode.WebviewView) {
        webviewView.webview.html = this._getHtmlForWebview();

        // Updates every second even when hidden
        setInterval(() => {
            this.updateContent();
        }, 1000);
    }
}
```

## Summary

You've learned:

- ✅ Creating custom view containers in activity bar
- ✅ Sidebar and panel integration
- ✅ Webview-based views
- ✅ Multiple views in containers
- ✅ Badge notifications
- ✅ View visibility and welcome content
- ✅ Complete project dashboard example
- ✅ Best practices for organization and performance

## Exercise

Create a "Workspace Manager" extension with:
1. Custom activity bar icon and container
2. Multiple related views:
   - Workspace overview (webview with stats)
   - Open editors tree
   - Workspace tasks tree
   - Quick settings (webview)
3. Badge showing number of pending tasks
4. Welcome view when no workspace is open
5. Context menus with relevant actions
6. Proper visibility conditions
7. Performance optimization for large workspaces

## Next Steps

Continue to [Module 4: Editor Integration](../module-04-editor-integration/README.md) to learn about working with text documents, decorations, and editor APIs.

## Additional Resources

- [View Containers API](https://code.visualstudio.com/api/extension-guides/tree-view#view-container)
- [WebviewView API](https://code.visualstudio.com/api/references/vscode-api#WebviewView)
- [Custom View Sample](https://github.com/microsoft/vscode-extension-samples/tree/main/custom-view-sample)
- [Webview View Sample](https://github.com/microsoft/vscode-extension-samples/tree/main/webview-view-sample)
