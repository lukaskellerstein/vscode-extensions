# 1.2 Development Environment Setup

## Prerequisites Check

Before we begin, ensure you have the following installed:

### Required Tools

#### 1. **Visual Studio Code**
- **Version**: Latest stable release
- **Download**: https://code.visualstudio.com/
- **Verify**:
  ```bash
  code --version
  ```

#### 2. **Node.js and npm**
- **Version**: Node.js 18.x or higher
- **Download**: https://nodejs.org/
- **Verify**:
  ```bash
  node --version  # Should show v18.x or higher
  npm --version   # Should show 9.x or higher
  ```

#### 3. **Git**
- **Version**: Latest stable
- **Download**: https://git-scm.com/
- **Verify**:
  ```bash
  git --version
  ```

### Installing Node.js

#### Linux (Ubuntu/Debian)
```bash
# Using NodeSource repository
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs

# Verify installation
node --version
npm --version
```

#### macOS
```bash
# Using Homebrew
brew install node

# Or download from https://nodejs.org/
```

#### Windows
Download the installer from https://nodejs.org/ and run it.

## Installing Extension Development Tools

### 1. **Yeoman and Extension Generator**

Yeoman (yo) is a scaffolding tool that generates project templates.

```bash
# Install globally
npm install -g yo generator-code

# Verify installation
yo --version
```

The `generator-code` is the official VS Code extension generator.

### 2. **vsce (Visual Studio Code Extensions)**

vsce is the command-line tool for packaging and publishing extensions.

```bash
# Install globally
npm install -g @vscode/vsce

# Verify installation
vsce --version
```

### 3. **TypeScript Compiler (Optional but Recommended)**

```bash
# Install globally for command-line usage
npm install -g typescript

# Verify installation
tsc --version
```

## Configuring VS Code for Extension Development

### Recommended Settings

Create or update your VS Code user settings:

**File** → **Preferences** → **Settings** (or `Ctrl+,`)

Add these settings:

```json
{
  // TypeScript
  "typescript.updateImportsOnFileMove.enabled": "always",
  "typescript.suggest.autoImports": true,

  // Editor
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },

  // Files
  "files.exclude": {
    "**/.git": true,
    "**/.DS_Store": true,
    "**/node_modules": true,
    "**/out": true
  },

  // Extension Development
  "debug.javascript.usePreview": false,
  "extensions.autoUpdate": false // Prevent auto-updates during development
}
```

### Recommended VS Code Extensions

Install these extensions to enhance your development experience:

#### Essential Extensions

1. **ESLint**
   - ID: `dbaeumer.vscode-eslint`
   - Purpose: JavaScript/TypeScript linting
   ```bash
   code --install-extension dbaeumer.vscode-eslint
   ```

2. **Prettier - Code formatter**
   - ID: `esbenp.prettier-vscode`
   - Purpose: Code formatting
   ```bash
   code --install-extension esbenp.prettier-vscode
   ```

3. **npm Intellisense**
   - ID: `christian-kohler.npm-intellisense`
   - Purpose: Autocomplete npm modules
   ```bash
   code --install-extension christian-kohler.npm-intellisense
   ```

4. **Path Intellisense**
   - ID: `christian-kohler.path-intellisense`
   - Purpose: Autocomplete file paths
   ```bash
   code --install-extension christian-kohler.path-intellisense
   ```

#### Helpful Extensions

5. **GitLens**
   - ID: `eamodio.gitlens`
   - Purpose: Enhanced Git integration
   ```bash
   code --install-extension eamodio.gitlens
   ```

6. **Todo Tree**
   - ID: `gruntfuggly.todo-tree`
   - Purpose: Track TODO comments
   ```bash
   code --install-extension gruntfuggly.todo-tree
   ```

7. **Thunder Client**
   - ID: `rangav.vscode-thunder-client`
   - Purpose: API testing (if your extension makes API calls)
   ```bash
   code --install-extension rangav.vscode-thunder-client
   ```

8. **Extension Test Runner**
   - ID: `ms-vscode.extension-test-runner`
   - Purpose: Run extension tests
   ```bash
   code --install-extension ms-vscode.extension-test-runner
   ```

### Install All at Once

```bash
code --install-extension dbaeumer.vscode-eslint \
     --install-extension esbenp.prettier-vscode \
     --install-extension christian-kohler.npm-intellisense \
     --install-extension christian-kohler.path-intellisense \
     --install-extension eamodio.gitlens \
     --install-extension gruntfuggly.todo-tree
```

## Setting Up Your Workspace

### Create a Development Directory

```bash
# Create a directory for your extension projects
mkdir -p ~/vscode-extensions
cd ~/vscode-extensions
```

### Initialize Git Configuration

If you haven't configured Git yet:

```bash
git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"
```

## Testing Your Setup

### Verify All Tools

Create a test script to verify your setup:

```bash
# Create a test file
cat > test-setup.sh << 'EOF'
#!/bin/bash
echo "=== VS Code Extension Development Setup Verification ==="
echo ""

echo "1. Node.js version:"
node --version || echo "❌ Node.js not found"
echo ""

echo "2. npm version:"
npm --version || echo "❌ npm not found"
echo ""

echo "3. Git version:"
git --version || echo "❌ Git not found"
echo ""

echo "4. VS Code version:"
code --version || echo "❌ VS Code not found"
echo ""

echo "5. Yeoman:"
yo --version || echo "❌ Yeoman not found"
echo ""

echo "6. vsce:"
vsce --version || echo "❌ vsce not found"
echo ""

echo "7. TypeScript:"
tsc --version || echo "❌ TypeScript not found (optional)"
echo ""

echo "=== Setup verification complete ==="
EOF

# Make it executable
chmod +x test-setup.sh

# Run it
./test-setup.sh
```

Expected output should show versions for all tools.

## Creating Your First Extension Workspace

Let's create a test extension to verify everything works:

```bash
# Navigate to your extensions directory
cd ~/vscode-extensions

# Run the extension generator
yo code
```

You'll be prompted with questions:

```
? What type of extension do you want to create? New Extension (TypeScript)
? What's the name of your extension? test-extension
? What's the identifier of your extension? test-extension
? What's the description of your extension? Testing my setup
? Initialize a git repository? Yes
? Bundle the source code with webpack? No
? Which package manager to use? npm
```

### Open the Extension

```bash
cd test-extension
code .
```

### Run the Extension

1. Press `F5` or go to **Run** → **Start Debugging**
2. A new VS Code window opens (Extension Development Host)
3. Press `Ctrl+Shift+P` and type "Hello World"
4. Select the command and see the notification

If you see "Hello World from test-extension!" notification, congratulations! Your setup is complete.

## Troubleshooting

### Common Issues

#### Issue 1: `yo` command not found

**Solution**:
```bash
# Check npm global bin directory
npm config get prefix

# Add to PATH (Linux/macOS)
export PATH="$PATH:$(npm config get prefix)/bin"

# Add to PATH permanently (Linux/macOS)
echo 'export PATH="$PATH:$(npm config get prefix)/bin"' >> ~/.bashrc
source ~/.bashrc
```

#### Issue 2: Extension doesn't start (F5)

**Solution**:
- Ensure you're in the extension directory
- Check that `node_modules` exists (run `npm install` if not)
- Check the Debug Console for errors
- Try `npm run compile` to build TypeScript

#### Issue 3: TypeScript errors

**Solution**:
```bash
# Reinstall dependencies
rm -rf node_modules package-lock.json
npm install

# Rebuild
npm run compile
```

#### Issue 4: Cannot find module 'vscode'

**Solution**:
```bash
# Ensure @types/vscode is installed
npm install --save-dev @types/vscode

# Check engines.vscode in package.json matches installed version
```

### Getting Help

- Check the [VS Code Extension Development FAQ](https://code.visualstudio.com/api/working-with-extensions/publishing-extension#common-questions)
- Search on [Stack Overflow - vscode-extensions tag](https://stackoverflow.com/questions/tagged/vscode-extensions)
- Join the [VS Code Discord](https://aka.ms/vscode-discord)

## Development Workflow Setup

### Recommended Terminal Setup

Configure an integrated terminal for development:

**Terminal** → **New Terminal** (`` Ctrl+` ``)

Create tasks for common operations:

**.vscode/tasks.json**:
```json
{
  "version": "2.0.0",
  "tasks": [
    {
      "type": "npm",
      "script": "watch",
      "problemMatcher": "$tsc-watch",
      "isBackground": true,
      "presentation": {
        "reveal": "never"
      },
      "group": {
        "kind": "build",
        "isDefault": true
      }
    },
    {
      "type": "npm",
      "script": "compile",
      "problemMatcher": "$tsc",
      "presentation": {
        "reveal": "never"
      },
      "group": "build"
    }
  ]
}
```

### Keyboard Shortcuts

Remember these essential shortcuts:

- `F5` - Start Debugging (Extension Development Host)
- `Ctrl+Shift+F5` - Restart Extension Host
- `Ctrl+Shift+P` - Command Palette
- `Ctrl+Shift+Y` - Debug Console
- `` Ctrl+` `` - Toggle Terminal

## Summary

You've successfully:

- ✅ Installed Node.js, npm, and Git
- ✅ Installed extension development tools (Yeoman, vsce)
- ✅ Configured VS Code with recommended settings
- ✅ Installed helpful VS Code extensions
- ✅ Created and run a test extension
- ✅ Set up your development workflow

## Next Steps

Now that your environment is ready, continue to [1.3 Your First Extension](./1.3-first-extension.md) to start building!

## Additional Resources

- [VS Code Extension Development Setup](https://code.visualstudio.com/api/get-started/your-first-extension)
- [Node.js Installation Guide](https://nodejs.org/en/download/package-manager/)
- [TypeScript Documentation](https://www.typescriptlang.org/docs/)

## Checklist

Before proceeding, ensure:

- [ ] Node.js v18+ installed and verified
- [ ] npm working correctly
- [ ] VS Code installed and updated
- [ ] Yeoman and generator-code installed
- [ ] vsce installed
- [ ] Test extension created and runs successfully
- [ ] ESLint extension installed
- [ ] Comfortable with VS Code debugging (F5)
